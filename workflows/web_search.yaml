name: "Search Web and Answer"
description: "Search the web about a topic and write an answer response based on the web search results."
version: "1.0"

inputs:
  user_query:
    type: "string"
    description: "The question you want to ask the agent."
    default: "What's the price of RTX 5090?"

steps:
  - id: "prompt_refinement"
    type: "agent_map"
    params:
      agent: "simple_agent"
      prompts: 
        - |
          Please write a web search string for the user's query below. Write only the search string in your response. Nothing else. 

          {{ inputs.user_query }}
      write_response_to_output: False

  - id: "web_search"
    type: "web_search"
    params:
      query: "{{ steps.prompt_refinement.content }}"

  - id: "answer_question"
    type: "agent_reduce"
    params:
      agent: "simple_agent"
      prompts: "{{ steps.web_search.content }}"
      prompts_prefix: |
          Please answer user's questions below based on the relevant web articles in your clipboard 

          {{ inputs.user_query }}
      output_filename: "answer.md"
      write_response_to_output: True

outputs:
  answer:
    description: "Answer to original question"
    value: "{{ steps.answer_question.content[0] }}"
  web_search_results:
    description: "Web Search Results"
    value: "{{ steps.web_search.content }}"
